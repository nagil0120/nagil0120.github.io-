<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ê∂àÈò≤Ëªä„É¢„Ç∞„É©„Åü„Åü„Åç„Ç≤„Éº„É†</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #f0f8ff;
      text-align: center;
      user-select: none;
    }
    canvas {
      background-color: #d0f0ff;
      display: block;
      margin: 0 auto;
      border: 2px solid #333;
    }
    h1 {
      font-family: 'Arial', sans-serif;
      color: #e60000;
      margin-top: 10px;
    }
    button {
      font-size: 20px;
      margin: 10px;
      padding: 10px 20px;
      border-radius: 10px;
      border: none;
      background-color: #ff4d4d;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #ff1a1a;
    }
  </style>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff0000">
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
      .then(reg => console.log('Service Worker registered:', reg))
      .catch(err => console.log('Service Worker registration failed:', err));
    });
  }
</script>



</head>
<body>
  <h1>üöí Ê∂àÈò≤Ëªä„É¢„Ç∞„É©„Åü„Åü„Åç„Ç≤„Éº„É† üöí</h1>
  <button id="startButton">„Çπ„Çø„Éº„Éà</button>
  <button id="restartButton" style="display:none;">„ÇÇ„ÅÜ„ÅÑ„Å£„Åã„ÅÑÔºÅ</button>
  <canvas id="gameCanvas" width="600" height="400"></canvas>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const startButton = document.getElementById('startButton');
    const restartButton = document.getElementById('restartButton');

    const houseImg = new Image();
    houseImg.src = 'https://tsukatte.com/wp-content/uploads/2022/01/house_01.png';

    const fireTruckImg = new Image();
    fireTruckImg.src = 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhtizE_qlz84s3OhwmHS8ZylEL58Khmjv1GN_kxdGnWjq8uvWkd7gfQKV1fF76pAMtpA3Yu0BLroCKl5EuHVocUOp_PqWd5koEJ_y13u6n67yDrNjwhpQIcc27mrD6RTDJckXizkD2CokY/s400/car_character5_syoubousya.png';

    const fireIcon = new Image();
    fireIcon.src = 'https://tsukatte.com/wp-content/uploads/2022/01/flame.png';

    const houses = [];
    const numHouses = 6;
    const houseWidth = 100;
    const houseHeight = 100;

    for (let i = 0; i < numHouses; i++) {
      houses.push({
        x: 60 + (i % 3) * 180,
        y: 120 + Math.floor(i / 3) * 150,
        onFire: false
      });
    }

    let fireTruck = { x: -100, y: -100 };
    let score = 0;
    let timeLeft = 30;
    let gameActive = false;
    let fireInterval, drawInterval, timer;

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      houses.forEach(house => {
        ctx.drawImage(houseImg, house.x, house.y, houseWidth, houseHeight);
        if (house.onFire) {
          ctx.drawImage(fireIcon, house.x + 20, house.y - 20, 60, 60);
        }
      });

      ctx.drawImage(fireTruckImg, fireTruck.x, fireTruck.y, 80, 60);

      ctx.fillStyle = 'black';
      ctx.font = '20px Arial';
      ctx.fillText('Score: ' + score, 10, 25);
      ctx.fillText('Time: ' + timeLeft, 500, 25);

      if (!gameActive && timeLeft === 0) {
        ctx.fillStyle = 'rgba(0,0,0,0.5)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = 'white';
        ctx.font = '40px Arial';
        ctx.fillText('Game Over!', 200, 200);
        ctx.font = '30px Arial';
        ctx.fillText('Final Score: ' + score, 220, 250);
        restartButton.style.display = 'inline-block';
      }
    }

    function randomFire() {
      if (!gameActive) return;
      const availableHouses = houses.filter(h => !h.onFire);
      if (availableHouses.length === 0) return;
      const house = availableHouses[Math.floor(Math.random() * availableHouses.length)];
      house.onFire = true;
      setTimeout(() => {
        house.onFire = false;
      }, 1500);
    }

    canvas.addEventListener('click', (e) => {
      if (!gameActive) return;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      houses.forEach(house => {
        if (x > house.x && x < house.x + houseWidth && y > house.y && y < house.y + houseHeight) {
          if (house.onFire) {
            house.onFire = false;
            score++;

            fireTruck.x = house.x - 10;
            fireTruck.y = house.y + houseHeight - 40;

            setTimeout(() => {
              fireTruck.x = -100;
              fireTruck.y = -100;
            }, 700);
          }
        }
      });
    });

    function startGame() {
      score = 0;
      timeLeft = 30;
      gameActive = true;
      restartButton.style.display = 'none';
      startButton.style.display = 'none';

      fireInterval = setInterval(() => {
        randomFire();
      }, 1000);

      drawInterval = setInterval(() => {
        draw();
      }, 100);

      timer = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
        } else {
          clearInterval(timer);
          clearInterval(fireInterval);
          clearInterval(drawInterval);
          gameActive = false;
          draw();
        }
      }, 1000);
    }

    restartButton.addEventListener('click', startGame);
    startButton.addEventListener('click', startGame);

    draw(); // ÂàùÊúüË°®Á§∫
  </script>
</body>
</html>
